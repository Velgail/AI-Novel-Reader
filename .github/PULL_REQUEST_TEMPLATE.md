<!-- please review in Japanese -->
## このプルリクエストで何をしたか？ (What)
## なぜそうしたか？ (Why)
## どうやって確認したか？ (How)
## 影響範囲 (Impact)
## その他 (Optional)


# for GitHub Copilot review rule

### お願い
- Pull Request Overview、Reviewed Changes、コメントは**全て必ず日本語で**書いてください。

### 1. レビュー対象と範囲
- 次の観点でコード品質の改善提案を行ってください:
  - ロジックの正確性 (仕様通りか、エッジケースは考慮されているか)
  - セキュリティ上の問題 (脆弱性がないか)
  - パフォーマンスの最適化 (ボトルネックや冗長な処理がないか)
  - データ競合の可能性
  - 一貫性の維持 (プロジェクト全体、ファイル内)
  - エラーハンドリング (適切に処理されているか)
  - 保守性の向上 (可読性、モジュール性、変更容易性)
  - コードの複雑性軽減
  - ベストプラクティス (DRY, SOLID, KISS など) の適用
- 重大な問題（例：テスト失敗、脆弱性、処理効率の著しい低下など）に絞ってレビューしてください。
- 以下については**コメントしないでください**:
  - 軽微なコードスタイルの問題 (インデント、スペース、空行など - Linter/Formatter に任せる範囲)
  - コメント/ドキュメントの不足 (ただし、Docstring の形式が規約違反の場合は指摘してください)
  - `db/**`, `**/*.lock`, `**/migrations/*` など、特定のパス配下のファイル
  - 自動生成されたコード（例: `l10n`, `freezed`, `*.generated.py` など）

### 2. コーディング規約 (Python)
以下の Python コーディング規約に従ってレビューしてください。

#### 2.1. コードレイアウト
* **インデント:** スペース4つ。タブは不可。
* **行の長さ:** 最大100文字。超える場合は適切に改行。
* **空行:** トップレベル定義間は2行、クラス内メソッド間は1行。関数内では論理セクション区切りに適度に使用。
* **インポート:** ファイル先頭に記述。標準ライブラリ → サードパーティ → ローカルの順でグループ化し、各グループ間は1行空ける。グループ内はアルファベット順。`from <module> import *` は禁止。絶対インポート推奨。

#### 2.2. 命名規則
* **変数/関数/メソッド:** `snake_case` (例: `user_name`, `calculate_total()`)
* **定数:** `SNAKE_CASE` (例: `MAX_OVERFLOW`)
* **クラス:** `CapWords` (例: `UserService`)
* **モジュール:** 短く、小文字の `snake_case` (例: `user_utils.py`)
* **パッケージ:** 短く、小文字。アンダースコア非推奨 (例: `services`)
* **プライベート:** アンダースコアで開始 (`_internal_value`)。
* **予約語衝突回避:** 末尾にアンダースコア (`class_`)。

#### 2.3. コメントと Docstring
* **コメント (`#`):** 「なぜ」そうなっているかを説明。複雑な箇所や意図が分かりにくい箇所に。
* **Docstring (`"""..."""`):** 全ての公開モジュール、関数、クラス、メソッドに必須。
    * 1行目に要約。
    * 必要に応じ詳細、`Args:`, `Returns:`, `Raises:` を記述 (Google スタイル推奨)。
    ```python
    def calculate_area(width: float, height: float) -> float:
        """矩形の面積を計算します。

        Args:
            width (float): 矩形の幅。
            height (float): 矩形の高さ。

        Returns:
            float: 計算された面積。

        Raises:
            ValueError: 幅または高さが負の場合。
        """
        # ... 実装 ...
    ```

#### 2.4. 型ヒント (PEP 484)
* 可能な限り使用。`typing` モジュールを活用 (例: `List[int]`, `Optional[str]`)。

#### 2.5. エラーハンドリング
* 具体的な例外クラスを使用。汎用的な `Exception` のキャッチは避ける。
* `try...except` は最小限の範囲に適用。
* 例外をキャッチしたらログ記録、処理、または再送出。`pass` で無視しない。

#### 2.6. テスト
* 重要な機能には単体テストを作成 (`unittest` or `pytest`)。

#### 2.7. その他
* **マジックナンバー:** 定数を使用。
* **Boolean 比較:** `if is_active:` や `if not result:` を使用。
* **文字列フォーマット:** f-string 推奨 (Python 3.6+)。
* **コンテキストマネージャ:** リソース管理には `with` 文を使用。
<!-- please review in Japanese -->
